
/**
 * lulutia
 * Version: 0.0.1
 * Copyright 2015 - 2015 
 */
 define(function(require,a,b){"use strict";var c,d;return c={},d=require("echarts"),c.init=function(){return c.getData(),c.eventBind()},c.getData=function(){return $.ajax({type:"get",url:"./data/country.json",dataType:"json",success:function(a,b){return c.dataHandle(a)}})},c.eventBind=function(){return $("#J-allnav li").click(function(){return $(this).parent().find("li").removeClass("active"),$(this).addClass("active")})},c.dataHandle=function(a){var b,d,e,f,g,h,i;for(c.allType={},b=0,h=a.length;h>b;b++)for(d=a[b],g=Object.keys(d),e=0,i=g.length;i>e;e++)f=g[e],c.allType[f]=c.allType[f]||[],c.allType[f].push(d[f]);return c.dataProcess(c.allType)},c.dataProcess=function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p;for(p=$("#J-allnav li.active").attr("value").toString(),o=[],g={name:p,type:"map",mapType:"china",hoverable:!1,roam:!0,data:[],markPoint:{symbolSize:5,itemStyle:{normal:{borderColor:"#87cefa",borderWidth:1,label:{show:!1}},emphasis:{borderColor:"#1e90ff",borderWidth:5,label:{show:!1}}},data:[]}},m=a[p],e=d=0,i=m.length;i>d;e=++d)b=m[e],k={},k.name=a.area[e],k.value=b,k.value>c.max&&(c.max=k.value),g.markPoint.data.push(k);for(n=a.area,h=0,j=n.length;j>h;h++)f=n[h],c.ajaxt(f),c.flag=a.area.length;l=setInterval(function(a){return function(){return 0===c.flag?(g.geoCoord=c.geocoord,o.push(g),c.initChart(o),clearInterval(l)):void 0}}(this),100)},c.geocoord={},c.max=0,c.ajaxt=function(a){return $.ajax({type:"get",url:"http://api.map.baidu.com/geocoder/v2/",dataType:"jsonp",data:{output:"json",ak:"ZXhtdkazbuOxPmG6xB0609zB",address:a},success:function(b,d){return 0===b.status?(c.geocoord[a]=[],c.geocoord[a].push(b.result.location.lng),c.geocoord[a].push(b.result.location.lat)):(c.geocoord[a].push(0),c.geocoord[a].push(0)),c.flag--}})},c.initChart=function(a){var b;return this.airchart=d.init(document.getElementById("airall_chart")),b={title:{text:"全国气候状况",subtext:"数据取自"},dataRange:{min:0,max:c.max,calculable:!0,color:["maroon","purple","red","orange","yellow","lightgreen"]},tooltip:{trigger:"item"},series:a},this.airchart.setOption(b)},b.exports=c});